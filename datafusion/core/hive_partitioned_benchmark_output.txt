=== Query: Group By Partition Col (Optimized) [SELECT part_col, count(*) FROM t GROUP BY part_col] ===
--- Plan ---
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Projection: t.part_col, count(Int64(1)) AS count(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |   Aggregate: groupBy=[[t.part_col]], aggr=[[count(Int64(1))]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |     TableScan: t projection=[part_col]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| physical_plan | ProjectionExec: expr=[part_col@0 as part_col, count(Int64(1))@1 as count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |   AggregateExec: mode=SinglePartitioned, gby=[part_col@0 as part_col], aggr=[count(Int64(1))]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |     DataSourceExec: file_groups={16 groups: [[var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=0/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=16/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=32/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=48/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=64/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=1/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=17/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=33/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=49/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=65/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=2/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=18/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=34/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=50/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=66/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=3/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=19/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=35/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=51/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=67/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=4/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=20/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=36/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=52/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=68/data.parquet, ...], ...]}, projection=[part_col], file_type=parquet |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

=== Query: Group By Partition Col (Unoptimized) [SELECT part_col, count(*) FROM t GROUP BY part_col] ===
--- Plan ---
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Projection: t.part_col, count(Int64(1)) AS count(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |   Aggregate: groupBy=[[t.part_col]], aggr=[[count(Int64(1))]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |     TableScan: t projection=[part_col]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| physical_plan | ProjectionExec: expr=[part_col@0 as part_col, count(Int64(1))@1 as count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |   AggregateExec: mode=FinalPartitioned, gby=[part_col@0 as part_col], aggr=[count(Int64(1))]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |       RepartitionExec: partitioning=Hash([part_col@0], 16), input_partitions=16                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |         AggregateExec: mode=Partial, gby=[part_col@0 as part_col], aggr=[count(Int64(1))]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |           RepartitionExec: partitioning=RoundRobinBatch(16), input_partitions=15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |             DataSourceExec: file_groups={15 groups: [[var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=0/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=1/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=10/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=11/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=12/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=15/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=16/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=17/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=18/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=19/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=21/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=22/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=23/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=24/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=25/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=28/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=29/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=3/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=30/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=31/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=34/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=35/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=36/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=37/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=38/data.parquet, ...], ...]}, projection=[part_col], file_type=parquet |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

=== Query: Group By Partition+Val (Optimized) [SELECT part_col, val, count(*) FROM t GROUP BY part_col, val] ===
--- Plan ---
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Projection: t.part_col, t.val, count(Int64(1)) AS count(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |   Aggregate: groupBy=[[t.part_col, t.val]], aggr=[[count(Int64(1))]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |     TableScan: t projection=[val, part_col]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| physical_plan | ProjectionExec: expr=[part_col@0 as part_col, val@1 as val, count(Int64(1))@2 as count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |   AggregateExec: mode=SinglePartitioned, gby=[part_col@1 as part_col, val@0 as val], aggr=[count(Int64(1))]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |     DataSourceExec: file_groups={16 groups: [[var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=0/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=16/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=32/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=48/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=64/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=1/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=17/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=33/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=49/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=65/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=2/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=18/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=34/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=50/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=66/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=3/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=19/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=35/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=51/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=67/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=4/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=20/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=36/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=52/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=68/data.parquet, ...], ...]}, projection=[val, part_col], file_type=parquet |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

=== Query: Group By Partition+Val (Unoptimized) [SELECT part_col, val, count(*) FROM t GROUP BY part_col, val] ===
--- Plan ---
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Projection: t.part_col, t.val, count(Int64(1)) AS count(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |   Aggregate: groupBy=[[t.part_col, t.val]], aggr=[[count(Int64(1))]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |     TableScan: t projection=[val, part_col]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| physical_plan | ProjectionExec: expr=[part_col@0 as part_col, val@1 as val, count(Int64(1))@2 as count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |   AggregateExec: mode=FinalPartitioned, gby=[part_col@0 as part_col, val@1 as val], aggr=[count(Int64(1))]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |       RepartitionExec: partitioning=Hash([part_col@0, val@1], 16), input_partitions=16                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |         AggregateExec: mode=Partial, gby=[part_col@1 as part_col, val@0 as val], aggr=[count(Int64(1))]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |           RepartitionExec: partitioning=RoundRobinBatch(16), input_partitions=15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |             DataSourceExec: file_groups={15 groups: [[var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=0/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=1/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=10/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=11/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=12/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=15/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=16/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=17/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=18/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=19/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=21/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=22/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=23/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=24/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=25/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=28/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=29/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=3/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=30/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=31/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=34/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=35/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=36/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=37/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=38/data.parquet, ...], ...]}, projection=[val, part_col], file_type=parquet |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

=== Query: Group By Non-Partition Col (Optimized) [SELECT val, count(*) FROM t GROUP BY val] ===
--- Plan ---
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Projection: t.val, count(Int64(1)) AS count(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |   Aggregate: groupBy=[[t.val]], aggr=[[count(Int64(1))]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |     TableScan: t projection=[val]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| physical_plan | ProjectionExec: expr=[val@0 as val, count(Int64(1))@1 as count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |   AggregateExec: mode=FinalPartitioned, gby=[val@0 as val], aggr=[count(Int64(1))]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |       RepartitionExec: partitioning=Hash([val@0], 16), input_partitions=16                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |         AggregateExec: mode=Partial, gby=[val@0 as val], aggr=[count(Int64(1))]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |           DataSourceExec: file_groups={16 groups: [[var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=0/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=16/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=32/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=48/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=64/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=1/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=17/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=33/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=49/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=65/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=2/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=18/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=34/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=50/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=66/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=3/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=19/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=35/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=51/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=67/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=4/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=20/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=36/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=52/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=68/data.parquet, ...], ...]}, projection=[val], file_type=parquet |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

=== Query: Group By Non-Partition Col (Unoptimized) [SELECT val, count(*) FROM t GROUP BY val] ===
--- Plan ---
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Projection: t.val, count(Int64(1)) AS count(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |   Aggregate: groupBy=[[t.val]], aggr=[[count(Int64(1))]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |     TableScan: t projection=[val]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| physical_plan | ProjectionExec: expr=[val@0 as val, count(Int64(1))@1 as count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |   AggregateExec: mode=FinalPartitioned, gby=[val@0 as val], aggr=[count(Int64(1))]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |       RepartitionExec: partitioning=Hash([val@0], 16), input_partitions=16                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |         AggregateExec: mode=Partial, gby=[val@0 as val], aggr=[count(Int64(1))]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |           RepartitionExec: partitioning=RoundRobinBatch(16), input_partitions=15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |             DataSourceExec: file_groups={15 groups: [[var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=0/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=1/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=10/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=11/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=12/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=15/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=16/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=17/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=18/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=19/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=21/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=22/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=23/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=24/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=25/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=28/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=29/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=3/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=30/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=31/data.parquet, ...], [var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=34/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=35/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=36/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=37/data.parquet, var/folders/_2/fhyfzzx171d3zvzp8swvrmv40000gp/T/.tmpc3nX8L/part_col=38/data.parquet, ...], ...]}, projection=[val], file_type=parquet |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

